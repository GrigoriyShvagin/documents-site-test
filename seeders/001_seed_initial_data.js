exports.seed = async function (knex) {
  // Очищаем таблицы в правильном порядке (из-за внешних ключей)
  await knex("messages").del();
  await knex("documents").del();
  await knex("users").del();

  // Вставляем пользователей и получаем их ID
  const userIds = await knex("users")
    .insert([
      {
        username: "admin",
        email: "admin@example.com",
        password: "admin123",
        role: "admin",
      },
      {
        username: "support",
        email: "support@example.com",
        password: "support123",
        role: "support",
      },
      {
        username: "user1",
        email: "user1@example.com",
        password: "user123",
        role: "user",
      },
      {
        username: "user2",
        email: "user2@example.com",
        password: "user123",
        role: "user",
      },
    ])
    .returning("id");

  // Получаем ID пользователей
  const adminId = userIds[0].id;
  const supportId = userIds[1].id;
  const user1Id = userIds[2].id;
  const user2Id = userIds[3].id;

  // Вставляем документы
  await knex("documents").insert([
    {
      title: "Руководство пользователя",
      description: "Инструкция по работе с системой",
      content: `Добро пожаловать в систему управления документами!

Основные функции:
- Создание и редактирование документов
- Поиск по содержимому
- Ролевая система доступа

Для работы с системой:
1. Войдите в свой аккаунт
2. Создайте новый документ
3. Заполните название, описание и содержимое
4. Сохраните документ

Поддержка ролей:
- Пользователь: может создавать и редактировать свои документы
- Поддержка: дополнительно обрабатывает сообщения пользователей
- Админ: полный доступ ко всем функциям системы`,
      user_id: user1Id,
    },
    {
      title: "Отчет за месяц",
      description: "Ежемесячный отчет о работе",
      content: `ОТЧЕТ О РАБОТЕ ЗА ДЕКАБРЬ 2024

Основные достижения:
- Завершено 15 проектов
- Обработано 234 заявки
- Новых пользователей: 89

Статистика:
- Время отклика: 2.3 сек
- Удовлетворенность: 94%
- Доступность: 99.9%

Планы на следующий месяц:
- Улучшение производительности
- Добавление новых функций
- Расширение команды поддержки`,
      user_id: user1Id,
    },
    {
      title: "Презентация проекта",
      description: "Презентация для клиентов",
      content: `СИСТЕМА УПРАВЛЕНИЯ ДОКУМЕНТАМИ

Преимущества нашего решения:

БЕЗОПАСНОСТЬ
- Ролевая система доступа
- Шифрование данных
- Аудит всех действий

УДОБСТВО
- Интуитивный интерфейс
- Быстрый поиск
- Мобильная версия

МАСШТАБИРУЕМОСТЬ
- Поддержка тысяч пользователей
- Облачное развертывание
- API для интеграции

ПОДДЕРЖКА
- 24/7 техподдержка
- Обучение персонала
- Регулярные обновления`,
      user_id: user2Id,
    },
    {
      title: "Политика конфиденциальности",
      description: "Информация о том, как мы обрабатываем данные",
      content: `ПОЛИТИКА КОНФИДЕНЦИАЛЬНОСТИ

1. СБОР ИНФОРМАЦИИ
Мы собираем только необходимую информацию для работы сервиса.

2. ИСПОЛЬЗОВАНИЕ ДАННЫХ
Данные используются исключительно для предоставления услуг.

3. ЗАЩИТА ИНФОРМАЦИИ
Все данные защищены современными методами шифрования.

4. ПРАВА ПОЛЬЗОВАТЕЛЕЙ
Вы имеете право:
- Просматривать свои данные
- Редактировать информацию
- Удалить аккаунт

5. КОНТАКТЫ
По вопросам конфиденциальности обращайтесь к администратору.`,
      user_id: adminId,
    },
  ]);

  // Вставляем сообщения
  await knex("messages").insert([
    {
      user_id: user1Id,
      subject: "Проблема с загрузкой",
      message:
        "Не могу загрузить документ в систему. При попытке создать новый документ появляется ошибка. Можете помочь?",
    },
    {
      user_id: user2Id,
      subject: "Вопрос по функционалу",
      message:
        "Как удалить старый документ? Не могу найти кнопку удаления. Заранее спасибо за помощь!",
    },
  ]);
};
