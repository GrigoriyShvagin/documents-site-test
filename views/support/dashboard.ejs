<%- include('../partials/head', { title }) %> <%- include('../partials/header')
%>

<div class="container">
  <h1>–ü–∞–Ω–µ–ª—å –ø–æ–¥–¥–µ—Ä–∂–∫–∏</h1>

  <div class="support-stats">
    <div class="stat-card">
      <h3>üí¨ –ù–æ–≤—ã–µ —Å–æ–æ–±—â–µ–Ω–∏—è</h3>
      <p class="stat-number"><%= stats.newMessages %></p>
      <a href="/support/messages" class="btn btn-primary">–û–±—Ä–∞–±–æ—Ç–∞—Ç—å</a>
    </div>

    <div class="stat-card">
      <h3>üîÑ –í —Ä–∞–±–æ—Ç–µ</h3>
      <p class="stat-number"><%= stats.inProgressMessages %></p>
      <a href="/support/messages?status=in_progress" class="btn btn-secondary"
        >–ü—Ä–æ—Å–º–æ—Ç—Ä</a
      >
    </div>

    <div class="stat-card">
      <h3>‚úÖ –†–µ—à–µ–Ω–Ω—ã–µ</h3>
      <p class="stat-number"><%= stats.resolvedMessages %></p>
      <a href="/support/messages?status=resolved" class="btn btn-success"
        >–ü—Ä–æ—Å–º–æ—Ç—Ä</a
      >
    </div>
  </div>

  <div class="recent-messages">
    <h2>–ü–æ—Å–ª–µ–¥–Ω–∏–µ —Å–æ–æ–±—â–µ–Ω–∏—è</h2>
    <div class="messages-list">
      <% if (recentMessages && recentMessages.length > 0) { %> <%
      recentMessages.forEach(message => { %>
      <div class="message-card">
        <h4><%= message.subject %></h4>
        <p><%= message.message.substring(0, 100) %>...</p>
        <div class="message-meta">
          <span>–û—Ç: <%= message.username %></span>
          <span
            >–°—Ç–∞—Ç—É—Å: <%= message.status === 'new' ? '–ù–æ–≤–æ–µ' : message.status ===
            'in_progress' ? '–í —Ä–∞–±–æ—Ç–µ' : '–†–µ—à–µ–Ω–æ' %></span
          >
          <span
            ><%= new Date(message.created_at).toLocaleDateString('ru') %></span
          >
        </div>
        <a
          href="/support/messages/<%= message.id %>"
          class="btn btn-sm btn-outline"
          >–û—Ç–≤–µ—Ç–∏—Ç—å</a
        >
      </div>
      <% }); %> <% } else { %>
      <p>–ù–æ–≤—ã—Ö —Å–æ–æ–±—â–µ–Ω–∏–π –Ω–µ—Ç</p>
      <% } %>
    </div>
  </div>
</div>

<%- include('../partials/footer') %>
